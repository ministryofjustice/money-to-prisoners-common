{% load i18n %}
{% load mtp_common %}

{% comment %}
  USAGE:
  {% include 'mtp_common/forms/error-summary.html' with form=<form variable> only %}
{% endcomment %}

{% if form.errors %}
  <div class="error-summary" aria-labelledby="error-summary-heading" tabindex="-1" role="alert">
    <h1 class="error-summary-heading heading-medium" id="error-summary-heading">
      {% trans 'There was a problem' as error_summary_title %}
      {{ form.error_summary_title|default:error_summary_title }}
    </h1>
    <ol class="error-summary-list">
      {% get_form_errors form as errors %}
      {# NB: individual field errors are not repeated in the summary #}
      {#     but non-field errors are only included in the summary #}

      {% for error in errors.non_field %}
        <li class="non-field-error">{{ error }}<span class="screenreader-only">.</span></li>
      {% endfor %}

      {% for field, field_errors in errors.field_specific.items %}
        {% if forloop.first %}
          <li>
            {% if errors.non_field %}
              {% trans 'Also, please correct the following errors' %}
            {% else %}
              {% trans 'Please correct the following errors' %}
            {% endif %}
          </li>
        {% endif %}
        <li>
          <a href="#{{ field.id_for_label }}-label">{{ field.label }}</a>
          {% if debug %}
          <!--
          {{ field_errors|safeseq|join:'\n' }}
          -->
          {% endif %}
        </li>
      {% endfor %}

    </ol>
  </div>
{% endif %}
